# üåç TerraGrow Academy - Interactive 3D WebGL Experience

> Jeu √©ducatif d'agriculture de pr√©cision avec donn√©es satellites NASA en 3D

**Par OrbitSowers Labs** üá®üá≤ ‚Üí üá®üá¶
NASA Space Apps Challenge 2025 - Montr√©al

---

## ‚ú® Features

- üåç **Globe 3D interactif** - Cliquez sur les 15 r√©gions pr√©-d√©finies ou utilisez la g√©olocalisation
- üõ∞Ô∏è **Satellite en orbite** - Animation r√©aliste avec mod√®le 3D
- üì° **Donn√©es NASA en temps r√©el** - NASA POWER API (m√©t√©o, temp√©rature, pr√©cipitations)
- üéÆ **Gameplay immersif** - Simulation agricole 12 semaines avec irrigation/fertilisation
- üå± **6 cultures s√©lectionnables** - Bl√©, ma√Øs, riz, tournesol, tomate, laitue avec preview 3D
- üåæ **Sc√®ne 3D champ r√©aliste** - Mod√®les 3D GLB avec textures sol d√©taill√©es
- üìä **Interface HUD moderne** - Stats en temps r√©el + contr√¥les intuitifs
- üå§Ô∏è **Atmosph√®re immersive** - Ciel dynamique, brouillard, √©clairage r√©aliste
- üéØ **√âcran de r√©sultats d√©taill√©s** - Score, √©toiles, rendement, durabilit√©

---

## üöÄ Installation & D√©marrage

### Pr√©requis

- Node.js 18+ install√©
- Backend Flask TerraGrow en cours d'ex√©cution (`http://localhost:5000`)

### √âtapes

```bash
# 1. Se placer dans le dossier
cd TerraGrow_3D

# 2. Installer les d√©pendances
npm install

# 3. IMPORTANT: V√©rifier que les assets sont pr√©sents
# - public/textures/ doit contenir les textures Earth + sol
# - public/models/ doit contenir satellite.glb, wheat.glb, corn.glb

# 4. D√©marrer le serveur de d√©veloppement
npm run dev

# 5. Ouvrir http://localhost:3000 dans le navigateur
```

---

## üì¶ Setup Assets (IMPORTANT)

### Assets requis dans `public/` :

**Textures Earth** (`public/textures/`) :
```
2k_earth_daymap.jpg      (463 KB) - Texture jour
2k_earth_nightmap.jpg    (255 KB) - Texture nuit
2k_earth_clouds.jpg      (965 KB) - Nuages
2k_stars.jpg             (223 KB) - Fond √©toil√©
```

**Textures Sol** (`public/textures/`) :
```
brown_mud_02_diff_1k.jpg       - Sol diffuse (Poly Haven)
brown_mud_02_nor_dx_1k.jpg     - Sol normal map
leafy_grass_diff_1k.jpg        - Herbe
```

**Mod√®les 3D** (`public/models/`) :
```
satellite.glb            (4.2 MB) - Satellite NASA
wheat.glb                        - Bl√©
corn.glb                         - Ma√Øs
rice_plant.glb                   - Riz
sunflower.glb                    - Tournesol
tomato.glb                       - Tomate
lettuce.glb                      - Laitue
```

### Commande rapide (Windows PowerShell) :

```powershell
# Cr√©er les dossiers
New-Item -ItemType Directory -Force -Path public/textures
New-Item -ItemType Directory -Force -Path public/models

# Copier textures
Copy-Item ../glb/2k_earth_daymap.jpg public/textures/
Copy-Item ../glb/2k_earth_nightmap.jpg public/textures/
Copy-Item ../glb/2k_earth_clouds.jpg public/textures/
Copy-Item ../glb/2k_stars.jpg public/textures/

# Copier mod√®le
Copy-Item ../glb/satellite.glb public/models/
```

### Commande rapide (Linux/Mac) :

```bash
mkdir -p public/{textures,models}

cp ../glb/2k_earth_daymap.jpg public/textures/
cp ../glb/2k_earth_nightmap.jpg public/textures/
cp ../glb/2k_earth_clouds.jpg public/textures/
cp ../glb/2k_stars.jpg public/textures/

cp ../glb/satellite.glb public/models/
```

---

## üéÆ Comment jouer

### 1. Vue Globe
- **15 r√©gions cliquables** marqu√©es par des sph√®res orange/vertes avec drapeaux
- **Bouton "üìç Ma position"** pour utiliser la g√©olocalisation
- Les r√©gions tournent avec la Terre (rotation synchronis√©e)
- Hover sur une r√©gion ‚Üí elle s'agrandit et devient verte

### 2. S√©lection R√©gion & Culture
- Affichage des donn√©es **NASA POWER** en temps r√©el :
  - Climat de la r√©gion (ex: Tropical, Continental, Subtropical)
  - Temp√©rature moyenne
  - Pr√©cipitations pr√©vues
- **S√©lecteur de culture interactif** :
  - Aper√ßu 3D rotatif de la culture
  - 6 cultures disponibles : Bl√©, Ma√Øs, Riz, Tournesol, Tomate, Laitue
  - Cultures recommand√©es ‚ú® selon le climat
  - Libert√© de cultiver n'importe quelle culture
- Cliquez **"Commencer √† cultiver üå±"**

### 3. Vue Jeu (Champ 3D R√©aliste)
- **Barre sup√©rieure** : Stats en temps r√©el (Semaine, NDVI, Humidit√©, Azote, Budget)
- **Centre (plein √©cran)** : Sc√®ne 3D du champ
  - Sol textur√© avec relief (brown mud + herbe)
  - 16 plants 3D (culture s√©lectionn√©e)
  - Croissance dynamique selon NDVI
  - Animation de vent (balancement des plants)
  - Ciel dynamique avec soleil
  - Brouillard et √©clairage r√©aliste
- **Barre inf√©rieure** : Contr√¥les de gestion
  - üíß **Irrigation** : 0-50mm
  - üåø **Fertilisation** : 0-200 kg N/ha
  - Co√ªt en temps r√©el
  - Bouton validation semaine

### 4. Dynamique visuelle selon NDVI
- **NDVI √©lev√©** (>0.6) ‚Üí Plants grands et verts (sant√© excellente)
- **NDVI moyen** (0.3-0.6) ‚Üí Plants moyens et jaun√¢tres (stress mod√©r√©)
- **NDVI bas** (<0.3) ‚Üí Plants petits et rouge√¢tres (stress s√©v√®re)
- **La culture ne change jamais** durant les 12 semaines

### 5. Fin de saison (12 semaines)
- **√âcran de r√©sultats d√©taill√©** :
  - √âtoiles (1-5 ‚≠ê)
  - Rendement vs moyenne r√©gionale (t/ha)
  - Score durabilit√© (0-100)
  - Efficacit√© eau & azote
  - Budget restant
  - Recommandations personnalis√©es par climat
  - Graphique √©volution NDVI
- Bouton **"Nouvelle partie"** pour rejouer

---

## üèóÔ∏è Architecture

### Structure du projet

```
TerraGrow_3D/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Scene/            # Composants 3D
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Scene.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EarthGlobe.jsx      ‚≠ê Globe avec rotation synchronis√©e
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Satellite.jsx       üõ∞Ô∏è Orbite satellite (GLB + lumi√®re)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CameraController.jsx üì∑ Animations cam√©ra (zoom 1.6)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegionMarkers.jsx   üìç 15 r√©gions cliquables + hover
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Lights.jsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Field/            # Sc√®ne champ 3D r√©aliste
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ FieldScene.jsx      üåæ Sol textur√© + 16 plants GLB
‚îÇ   ‚îÇ   ‚îÇ                           üå§Ô∏è Ciel + fog + lumi√®res
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UI/               # Interface overlay
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Header.jsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RegionCard.jsx      üìã Fiche r√©gion
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ CropSelector.jsx    üå± S√©lecteur cultures 3D
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ GameInterface.jsx   üéÆ HUD stats + contr√¥les
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ResultsScreen.jsx   üèÜ √âcran de r√©sultats
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ GlobeControls.jsx   üìç Bouton g√©olocalisation
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ LoadingScreen.jsx
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useNASAData.js          üì° Hook API NASA
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ coordinates.js          üßÆ Lat/lon ‚Üî 3D
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ apiClient.js            üåê Wrapper Flask API
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ stores/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gameStore.js            üíæ Zustand state management
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ styles/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ global.css
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ App.jsx
‚îÇ   ‚îî‚îÄ‚îÄ main.jsx
‚îÇ
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ satellite.glb           üõ∞Ô∏è Mod√®le 3D satellite
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wheat.glb               üåæ Bl√©
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ corn.glb                üåΩ Ma√Øs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rice_plant.glb          üçö Riz
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sunflower.glb           üåª Tournesol
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tomato.glb              üçÖ Tomate
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lettuce.glb             ü•¨ Laitue
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ textures/
‚îÇ       ‚îú‚îÄ‚îÄ 2k_earth_daymap.jpg     üåç Texture jour
‚îÇ       ‚îú‚îÄ‚îÄ 2k_earth_nightmap.jpg   üåÉ Texture nuit
‚îÇ       ‚îú‚îÄ‚îÄ 2k_earth_clouds.jpg     ‚òÅÔ∏è Nuages
‚îÇ       ‚îú‚îÄ‚îÄ 2k_stars.jpg            ‚≠ê Fond √©toil√©
‚îÇ       ‚îú‚îÄ‚îÄ brown_mud_02_diff_1k.jpg     üå± Sol diffuse
‚îÇ       ‚îú‚îÄ‚îÄ brown_mud_02_nor_dx_1k.jpg   üå± Sol normal map
‚îÇ       ‚îî‚îÄ‚îÄ leafy_grass_diff_1k.jpg      üåø Herbe
‚îÇ
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ vite.config.js
‚îî‚îÄ‚îÄ README.md
```

### Stack technologique

- **React 18** - Framework UI
- **React Three Fiber (R3F)** - Abstraction React de Three.js
- **@react-three/drei** - Helpers R3F (OrbitControls, useGLTF, etc.)
- **@react-spring/three** - Animations cam√©ra
- **Zustand** - State management global
- **Vite** - Build tool moderne
- **Chart.js** - Graphiques (si ajout√©s)

---

## üîå Int√©gration Backend Flask

L'application se connecte au backend existant `OrbitSowers_TerraGrow/backend/` :

**API utilis√©es** :
- `POST /api/init` - Initialiser partie (lat/lon)
- `POST /api/action` - Valider semaine (irrigation/fertilisation)
- `GET /api/harvest` - R√©colte finale
- `GET /api/search-location` - Recherche lieu (Nominatim proxy)
- `GET /api/popular-regions` - 15 r√©gions pr√©-calcul√©es

**Configuration** : `src/utils/apiClient.js`

```javascript
const API_BASE_URL = 'http://localhost:5000/api'
```

**Important** : Le backend Flask doit √™tre **d√©marr√©** avant de lancer le frontend 3D.

```bash
# Terminal 1 : Backend
cd ../OrbitSowers_TerraGrow/backend
python app.py

# Terminal 2 : Frontend 3D
cd ../TerraGrow_3D
npm run dev
```

---

## üé® Customisation

### Modifier les couleurs du globe

`src/components/Scene/EarthGlobe.jsx` :
```javascript
<meshStandardMaterial
  map={dayMap}
  emissiveMap={nightMap}
  emissive={new THREE.Color(0x444444)}  // Couleur √©missive (nuit)
  emissiveIntensity={0.2}               // Intensit√©
  roughness={0.7}                        // Rugosit√©
  metalness={0.1}                        // Metallic
/>
```

### Ajuster la vitesse du satellite

`src/components/Scene/Satellite.jsx` :
```javascript
const speed = 0.3  // Modifier cette valeur (plus bas = plus lent)
```

### Changer la distance de zoom cam√©ra

`src/components/Scene/CameraController.jsx` :
```javascript
getCameraPositionForRegion(lat, lon, 1.8)  // Distance (1.8 = zoom proche)
```

---

## üêõ Troubleshooting

### Erreur: "Cannot find module 'three'"

```bash
npm install
```

### Erreur: "Failed to load textures"

V√©rifiez que les fichiers sont bien copi√©s dans `public/textures/` et `public/models/` :
```bash
ls public/textures/
ls public/models/
```

### Erreur: "API request failed"

- V√©rifiez que le backend Flask tourne sur `http://localhost:5000`
- Testez manuellement : `curl http://localhost:5000/api/health`

### Erreur: "Cannot animate between AnimatedValue and AnimatedArray"

‚úÖ **Corrig√©** dans CameraController.jsx - conversion Vector3 ‚Üí Array

### Globe ne s'affiche pas (√©cran noir)

1. Ouvrez la console navigateur (F12)
2. Cherchez erreurs Three.js
3. V√©rifiez que WebGL est support√© : `https://get.webgl.org/`

### Cultures ne s'affichent pas compl√®tement dans preview

‚úÖ **Corrig√©** - Cam√©ra et √©chelle optimis√©es par culture

### Performance lente / WebGL Context Lost

- Rafra√Æchissez la page (F5)
- R√©duire la r√©solution du globe si n√©cessaire
- V√©rifiez GPU dans gestionnaire de t√¢ches

---

## üìä Performance

### Benchmarks

- **FPS cible** : 60 FPS (desktop), 30 FPS (mobile)
- **Polygones globe** : ~8k triangles
- **Textures** : 2k r√©solution (optimis√©)
- **Draw calls** : ~10 par frame

### Optimisations futures

- [ ] LOD (Level of Detail) pour le globe
- [ ] Texture compression (basis format)
- [ ] Instanced rendering pour les markers
- [ ] Worker thread pour raycasting

---

## üöÄ Build Production

```bash
# Build optimis√©
npm run build

# Preview du build
npm run preview

# Dossier de sortie : dist/
```

**D√©ploiement** :
- Vercel, Netlify, GitHub Pages compatibles
- N√©cessite backend Flask s√©par√© (pas static)

---

## üìù TODO / Roadmap

### Phase 1 (MVP) - ‚úÖ Compl√©t√©
- [x] Globe 3D avec 15 r√©gions cliquables
- [x] Rotation synchronis√©e (Terre + nuages + markers)
- [x] Satellite en orbite avec mod√®le GLB
- [x] Cam√©ra animations (zoom fluide) - **Bug animation @react-spring corrig√©**
- [x] G√©olocalisation navigateur
- [x] Int√©gration API Flask compl√®te
- [x] **6 cultures s√©lectionnables** avec preview 3D rotatif
- [x] Recommandations cultures selon climat
- [x] Sc√®ne champ 3D r√©aliste :
  - [x] Sol textur√© (diffuse + normal map)
  - [x] 16 plants 3D (6 mod√®les GLB)
  - [x] Croissance dynamique selon NDVI
  - [x] Animation de vent
  - [x] Ciel dynamique + fog + lumi√®res
- [x] HUD stats + contr√¥les irrigation/fertilisation
- [x] √âcran de r√©sultats d√©taill√© avec graphique
- [x] **Affichage 3D cultures optimis√©** (preview complet)

### Phase 2 (Am√©liorations) - En cours
- [ ] **Corriger NDVI history** (13 points ‚Üí 12 points)
- [ ] **R√©soudre WebGL Context Lost** (optimisation cleanup)
- [ ] **Indicateurs visuels** irrigation/fertilisation recommand√©e
- [ ] Graphique NDVI Chart.js (√©volution 12 semaines)
- [ ] Particules irrigation (effet pluie 3D)
- [ ] Sons ambient (vent, pluie)
- [ ] Tutoriel interactif (tooltips)
- [ ] Mode mobile optimis√© (touch controls)

### Phase 3 (Avanc√©) - Futur
- [ ] Optimisation performances (LOD, instancing)
- [ ] Plus de mod√®les cultures (patate, sorgho)
- [ ] Earth.glb mod√®le haute qualit√©
- [ ] Clouds shader anim√© (parallax)
- [ ] Postprocessing (bloom, SSAO)
- [ ] Mode multijoueur (comparaison scores)
- [ ] Leaderboard r√©gional

---

## ü§ù Contribution

**√âquipe OrbitSowers Labs**
- Camerounais üá®üá≤ bas√©s √† Montr√©al üá®üá¶
- NASA Space Apps Challenge 2025

---

## üìú Licence

MIT License - Open Source

---

## üôè Cr√©dits

- **Textures Earth** : [Solar System Scope](https://www.solarsystemscope.com/textures/)
- **Textures Sol** : [Poly Haven](https://polyhaven.com) - Brown Mud 02, Leafy Grass
- **Mod√®les 3D** : Sketchfab (satellite.glb, wheat.glb, corn.glb)
- **NASA POWER API** : NASA Langley Research Center
- **Nominatim API** : OpenStreetMap
- **Three.js** : Three.js contributors
- **React Three Fiber** : Poimandres team (@pmndrs/drei)

---

## üìß Support

- **Issues** : GitHub Issues
- **Email** : contact@orbitsowers.com

---

**üåæ TerraGrow Academy - Cultiver l'avenir avec les yeux de la NASA**

*Hackathon NASA Space Apps Challenge 2025 - Montr√©al*
